<Page
    x:Class="BubbleShot.UniversalApp.Views.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:mvvm="using:Prism.Windows.Mvvm"
    xmlns:viewModels="using:BubbleShot.UniversalApp.ViewModels"
    xmlns:maps="using:Windows.UI.Xaml.Controls.Maps"
    xmlns:controls="using:WinRTXamlToolkit.Controls"
    xmlns:models="using:BubbleShot.UniversalApp.Models"
    xmlns:converters="using:BubbleShot.UniversalApp.Converters"
    xmlns:core="using:Microsoft.Xaml.Interactions.Core"
    xmlns:interactivity1="using:Microsoft.Xaml.Interactivity"
    mc:Ignorable="d" mvvm:ViewModelLocator.AutoWireViewModel="true" d:DataContext="{d:DesignInstance viewModels:MainPageViewModel }">
    <Page.Resources>
        <converters:NullVisibilityConverter x:Key="NullToVisibilityConverter"/>
    </Page.Resources>
    <FlipView HorizontalAlignment="Stretch" VerticalAlignment="Stretch" UseTouchAnimationsForAllNavigation="True">
        <FlipViewItem>
            <Grid Margin="0,0,20,0" Background="AntiqueWhite">
                <maps:MapControl x:ConnectionId='1' x:Name="Map"
                             MapServiceToken="uhWN34e4LCVOVBNwA3ZI~bzzP9OY-SZ_ay7FVUskS-w~Art6O_89BNl-_04hlwpqkWl7zErWSJdwuw3kz47zxb9FZ-nyJQKESG87Mh4wvI_G"
                             ZoomInteractionMode="GestureAndControl"
                             LandmarksVisible="True"
                             IsRightTapEnabled="True"
                                                                                                        >
                </maps:MapControl>

                <Border Background="RoyalBlue" Opacity="0.6" HorizontalAlignment="Right" Width="50">
                    <StackPanel Orientation="Vertical">
                        <StackPanel Orientation="Horizontal">
                            <Button FontFamily="Segoe MDL2 Assets" 
                                    Content="&#xE768;"
                                    Width="50" Height="50"
                                    Background="Transparent" 
                                    Command="{Binding StartAdapterCommand}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Button FontFamily="Segoe MDL2 Assets" Content="&#xE71A;"
                                    Width="50" Height="50" 
                                    Background="Transparent" 
                                    Command="{Binding StopAdapterCommand}"/>
                        </StackPanel>
                        <StackPanel>
                            <Slider Orientation="Vertical" Width="50" Height="200" Minimum="5000" Maximum="100000" Value="{Binding Radius, Mode=TwoWay}"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
            </Grid>
        </FlipViewItem>
        <FlipViewItem>
            <Grid>
                <GridView Margin="15" AutomationProperties.AutomationId="ItemGridView" ItemsSource="{Binding Photos}" SelectedItem="{Binding SelectedItem, Mode=TwoWay}">
                    <GridView.ItemTemplate>
                        <DataTemplate                                        >
                            <Grid HorizontalAlignment="Left" Width="150" Height="150">
                                <Border>
                                    <Image Source="{Binding Image}" Stretch="UniformToFill"/>
                                </Border>
                            </Grid>
                        </DataTemplate>
                    </GridView.ItemTemplate>
                    <GridView.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapGrid ItemWidth="200" ItemHeight="200"
                      Orientation="Horizontal" VerticalChildrenAlignment="Top"></WrapGrid>
                        </ItemsPanelTemplate>
                    </GridView.ItemsPanel>
                </GridView>

                <Grid HorizontalAlignment="Center" MaxHeight="600" MaxWidth="600">
                    <StackPanel MaxHeight="700" MaxWidth="700" Orientation="Vertical" Background="Azure" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="{Binding SelectedItem, Converter={StaticResource NullToVisibilityConverter}}">
                        <HyperlinkButton Command="{Binding CLoseDetails}" Margin="10" HorizontalAlignment="Right">Закрыть</HyperlinkButton>
                        <StackPanel Orientation="Vertical" Margin="20">
                            <HyperlinkButton NavigateUri="{Binding SelectedItem.UserLink}" Content="{Binding SelectedItem.UserLink}"/>
                            <Border MaxWidth="500" MaxHeight="500">
                                <Image Stretch="UniformToFill" Source="{Binding SelectedItem.Image}">
                                    <!--кусочек кода для возможности закрытия фотографии по тапу-->
                                    <interactivity1:Interaction.Behaviors>
                                        <interactivity1:BehaviorCollection>
                                            <core:EventTriggerBehavior EventName="Tapped">
                                                <core:InvokeCommandAction Command="{Binding CLoseDetails}"></core:InvokeCommandAction>
                                            </core:EventTriggerBehavior>
                                        </interactivity1:BehaviorCollection>
                                    </interactivity1:Interaction.Behaviors>
                                </Image>
                            </Border>
                        </StackPanel>
                    </StackPanel>

                </Grid>
            </Grid>
        </FlipViewItem>
    </FlipView>

</Page>

